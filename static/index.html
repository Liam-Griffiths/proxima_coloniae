<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proxima Coloniae</title>
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
    <script src="https://unpkg.com/hyperscript.org@0.9.8"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
<div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold mb-4">Proxima Coloniae</h1>

    <div class="grid grid-cols-2 gap-4">
        <div>
            <h2 class="text-xl font-semibold mb-2">Register</h2>
            <form hx-post="/register" hx-target="#message" class="space-y-2">
                <input type="text" name="username" placeholder="Username" class="w-full p-2 border rounded" required>
                <input type="email" name="email" placeholder="Email" class="w-full p-2 border rounded" required>
                <input type="password" name="password" placeholder="Password" class="w-full p-2 border rounded" required>
                <button type="submit" class="w-full p-2 bg-blue-500 text-white rounded hover:bg-blue-600">Register</button>
            </form>
        </div>

        <div>
            <h2 class="text-xl font-semibold mb-2">Login</h2>
            <form hx-post="/login" hx-target="#message" class="space-y-2">
                <input type="email" name="email" placeholder="Email" class="w-full p-2 border rounded" required>
                <input type="password" name="password" placeholder="Password" class="w-full p-2 border rounded" required>
                <button type="submit" class="w-full p-2 bg-green-500 text-white rounded hover:bg-green-600">Login</button>
            </form>
        </div>
    </div>

    <div id="message" class="mt-4"></div>
</div>

<script>
    document.body.addEventListener('htmx:afterRequest', function(event) {
        if (event.detail.successful) {
            try {
                const response = JSON.parse(event.detail.xhr.response);
                if (response.token) {
                    localStorage.setItem('token', response.token);
                    window.location.href = '/account.html';
                }
            } catch (e) {
                console.error('Error parsing JSON:', e);
            }
        }
    });
</script>
</body>
</html>